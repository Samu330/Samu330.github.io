<!DOCTYPE html>
<html>
<head>
    <title>Tabla exportable a Excel</title>
    <script src="https://code.jquery.com/jquery-3.5.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
</head>
<body>
    <h1>Tabla exportable a Excel</h1>
    <input type="text" id="dataInput" placeholder="Ingrese los datos separados por coma">
    <button onclick="createTable()">Crear tabla</button>
    <button onclick="exportToExcel()">Exportar a Excel</button>
    <div id="tableContainer"></div>

    <script>
        function createTable() {
            var dataInput = document.getElementById("dataInput").value;
            var dataArray = dataInput.split(",");
            var tableHtml = "<table><thead><tr><th>ID</th><th>Nombre</th></tr></thead><tbody>";
            
            for (var i = 0; i < dataArray.length; i++) {
                tableHtml += "<tr><td>" + (i + 1) + "</td><td>" + dataArray[i] + "</td></tr>";
            }
            
            tableHtml += "</tbody></table>";
            document.getElementById("tableContainer").innerHTML = tableHtml;
        }

        function exportToExcel() {
            var wb = XLSX.utils.table_to_book(document.getElementsByTagName('table')[0], {sheet:"Sheet JS"});
            var wbout = XLSX.write(wb, {bookType: 'xlsx', type: 'binary'});
            
            function s2ab(s) {
                var buf = new ArrayBuffer(s.length);
                var view = new Uint8Array(buf);
                for (var i=0; i<s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
                return buf;
            }
            
            saveAs(new Blob([s2ab(wbout)], {type: "application/octet-stream"}), "tabla.xlsx");
        }
    </script>
</body>
</html>
